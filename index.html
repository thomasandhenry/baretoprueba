<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurante Interactivo</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <!-- Estilo CSS personalizado -->
    <style>
        button {
            padding: 10px 20px;
            font-size: 18px;
            background-color: green;
            color: white;
            border: none;
            cursor: pointer;
            margin: 5px;
        }

        button:hover {
            background-color: darkgreen;
        }

        #main {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #main button {
            width: 200px;
        }

        .dropdown-content {
            display: none;
            flex-direction: column;
            align-items: flex-start;
        }

        .dropdown.show .dropdown-content {
            display: flex;
        }

        #kitchenContent {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
    </style>
</head>
<body>
    <div id="main">
        <h1>Selecciona tu mesa</h1>
        <button onclick="goToCustomer(1)">Mesa 1</button>
        <button onclick="goToCustomer(2)">Mesa 2</button>
        <button onclick="goToCustomer(3)">Mesa 3</button>
        <button onclick="goToCustomer(4)">Mesa 4</button>
        <button onclick="goToCustomer(5)">Mesa 5</button>
        <button onclick="goToCustomer(6)">Mesa 6</button>
        <button onclick="goToCustomer(7)">Mesa 7</button>
        <button onclick="goToCustomer(8)">Mesa 8</button>
        <button onclick="goToCustomer(9)">Mesa 9</button>
        <button onclick="goToCustomer(10)">Mesa 10</button>
        <button onclick="goToKitchen()">COCINA</button>
    </div>

    <div id="customer" style="display:none;">
        <h1>Cliente - Mesa <span id="tableNumber"></span></h1>
        <div class="dropdown">
            <button onclick="toggleDropdown(this)">Entrantes</button>
            <div class="dropdown-content">
                <button onclick="addOrder('Jamón ibérico')">Jamón ibérico +</button>
                <button onclick="addOrder('Ensaladilla rusa')">Ensaladilla rusa +</button>
                <button onclick="addOrder('Croquetas')">Croquetas +</button>
            </div>
        </div>
        <div class="dropdown">
            <button onclick="toggleDropdown(this)">Platos principales</button>
            <div class="dropdown-content">
                <button onclick="addOrder('Filete de ternera')">Filete de ternera +</button>
                <button onclick="addOrder('Merluza al horno')">Merluza al horno +</button>
                <button onclick="addOrder('Tartar de salmon y aguacate')">Tartar de salmón y aguacate +</button>
            </div>
        </div>
        <div class="dropdown">
            <button onclick="toggleDropdown(this)">Postres</button>
            <div class="dropdown-content">
                <button onclick="addOrder('Tarta de la abuela')">Tarta de la abuela +</button>
                <button onclick="addOrder('Natillas')">Natillas +</button>
                <button onclick="addOrder('Tarta de queso y fruta')">Tarta de queso y fruta +</button>
            </div>
        </div>
        <div class="dropdown">
            <button onclick="toggleDropdown(this)">Bebidas</button>
            <div class="dropdown-content">
                <button onclick="addOrder('Cocacola')">Cocacola +</button>
                <button onclick="addOrder('Agua')">Agua +</button>
                <button onclick="addOrder('Cerveza')">Cerveza +</button>
                <button onclick="addOrder('Vino')">Vino +</button>
            </div>
        </div>
        <button onclick="goBack()">Atrás</button>
    </div>

    <div id="kitchen" style="display:none;">
        <h1>Cocina</h1>
        <input type="password" id="kitchenPassword" placeholder="Contraseña">
        <button onclick="checkPassword()">Entrar</button>
        <button onclick="goBack()">Atrás</button>
        <div id="kitchenContent" style="display:none;">
            <h2>Lista de Pedidos</h2>
            <ul id="orderList"></ul>
        </div>
    </div>

    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyD8h3lzN5yP5N0aZNjdmy7kDI0aClUc_Wk",
            authDomain: "clasepruebagad.firebaseapp.com",
            databaseURL: "https://clasepruebagad-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "clasepruebagad",
            storageBucket: "clasepruebagad.appspot.com",
            messagingSenderId: "319326223452",
            appId: "1:319326223452:web:90ce724342c15427a17a99"
        };
        firebase.initializeApp(firebaseConfig);
        var database = firebase.database();
        var currentTableNumber = null;

        function goToCustomer(tableNumber) {
            currentTableNumber = tableNumber;
            document.getElementById("main").style.display = "none";
            document.getElementById("customer").style.display = "block";
            document.getElementById("tableNumber").innerText = tableNumber;
        }

        function goToKitchen() {
            document.getElementById("main").style.display = "none";
            document.getElementById("kitchen").style.display = "block";
        }

        function goBack() {
            document.getElementById("customer").style.display = "none";
            document.getElementById("kitchen").style.display = "none";
            document.getElementById("main").style.display = "block";
            currentTableNumber = null;
        }

        function toggleDropdown(button) {
            var dropdownContent = button.nextElementSibling;
            dropdownContent.classList.toggle("show");
        }

        function addOrder(order) {
            if (currentTableNumber && order) {
                var orderRef = database.ref('orders/' + currentTableNumber);
                orderRef.once('value', function(snapshot) {
                    var orders = snapshot.val() || {};
                    if (orders[order]) {
                        orders[order]++;
                    } else {
                        orders[order] = 1;
                    }
                    orderRef.set(orders);
                });
                alert("Pedido enviado");
            } else {
                alert("Por favor, selecciona una mesa y un pedido");
            }
        }

        function checkPassword() {
            var password = document.getElementById("kitchenPassword").value;
            if (password === "cocina") {
                document.getElementById("kitchenPassword").style.display = "none";
                document.getElementById("kitchenContent").style.display = "block";
                loadOrders();
                database.ref('orders').on('value', function(snapshot) {
                    loadOrders();
                });
            } else {
                alert("Contraseña incorrecta");
            }
        }

        function loadOrders() {
            var orderList = document.getElementById("orderList");
            orderList.innerHTML = "";
            database.ref('orders').once('value').then(function(snapshot) {
                snapshot.forEach(function(childSnapshot) {
                    var tableNumber = childSnapshot.key;
                    var orders = childSnapshot.val();
                    var li = document.createElement("li");
                    var orderText = "Mesa " + tableNumber + ":";
                    var orderItems = [];
                    for (var item in orders) {
                        if (orders[item] > 1) {
                            orderItems.push(item + " x" + orders[item]);
                        } else {
                            orderItems.push(item);
                        }
                    }
                    orderText += "\n\t" + orderItems.join("\n\t");
                    li.innerText = orderText;
                    orderList.appendChild(li);
                });
            });
        }
    </script>
</body>
</html>
