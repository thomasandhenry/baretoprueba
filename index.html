<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurante Interactivo</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <!-- Estilo CSS personalizado -->
    <style>
        /* Estilo para los botones */
        button {
            padding: 10px 20px; /* Aumenta el padding para hacer los botones más grandes */
            font-size: 18px; /* Aumenta el tamaño de la fuente */
            background-color: green; /* Cambia el color de fondo a verde */
            color: white; /* Cambia el color del texto a blanco */
            border: none; /* Elimina el borde */
            cursor: pointer; /* Cambia el cursor al pasar el ratón sobre el botón */
            margin: 5px; /* Agrega un pequeño margen entre los botones */
        }

        /* Estilo para los botones al pasar el ratón */
        button:hover {
            background-color: darkgreen; /* Cambia el color de fondo a un verde más oscuro */
        }

        /* Disposición vertical de las mesas */
        #main {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #main button {
            width: 200px;
        }
    </style>
</head>
<body>
    <div id="main">
        <h1>Selecciona tu mesa</h1>
        <button onclick="goToCustomer(1)">Mesa 1</button>
        <button onclick="goToCustomer(2)">Mesa 2</button>
        <button onclick="goToCustomer(3)">Mesa 3</button>
        <button onclick="goToCustomer(4)">Mesa 4</button>
        <button onclick="goToCustomer(5)">Mesa 5</button>
        <button onclick="goToCustomer(6)">Mesa 6</button>
        <button onclick="goToCustomer(7)">Mesa 7</button>
        <button onclick="goToCustomer(8)">Mesa 8</button>
        <button onclick="goToCustomer(9)">Mesa 9</button>
        <button onclick="goToCustomer(10)">Mesa 10</button>
        <button onclick="goToKitchen()">COCINA</button>
    </div>

    <div id="customer" style="display:none;">
        <h1>Cliente - Mesa <span id="tableNumber"></span></h1>
        <input type="text" id="order" placeholder="Pedido">
        <button onclick="submitOrder()">Enviar</button>
        <button onclick="goBack()">Atrás</button>
    </div>

    <div id="kitchen" style="display:none;">
        <h1>Cocina</h1>
        <input type="password" id="kitchenPassword" placeholder="Contraseña">
        <button onclick="checkPassword()">Entrar</button>
        <button onclick="goBack()">Atrás</button>
        <div id="kitchenContent" style="display:none;">
            <h2>Lista de Pedidos</h2>
            <ul id="orderList"></ul>
        </div>
    </div>

    <script>
        // Tu configuración de Firebase (reemplaza con tu propia configuración)
        var firebaseConfig = {
            apiKey: "AIzaSyD8h3lzN5yP5N0aZNjdmy7kDI0aClUc_Wk",
            authDomain: "clasepruebagad.firebaseapp.com",
            databaseURL: "https://clasepruebagad-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "clasepruebagad",
            storageBucket: "clasepruebagad.appspot.com",
            messagingSenderId: "319326223452",
            appId: "1:319326223452:web:90ce724342c15427a17a99"
        };
        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        var database = firebase.database();

        var currentTableNumber = null;

        function goToCustomer(tableNumber) {
            currentTableNumber = tableNumber;
            document.getElementById("main").style.display = "none";
            document.getElementById("customer").style.display = "block";
            document.getElementById("tableNumber").innerText = tableNumber;
        }

        function goToKitchen() {
            document.getElementById("main").style.display = "none";
            document.getElementById("kitchen").style.display = "block";
        }

        function goBack() {
            document.getElementById("customer").style.display = "none";
            document.getElementById("kitchen").style.display = "none";
            document.getElementById("main").style.display = "block";
            currentTableNumber = null;
        }

        function submitOrder() {
            var order = document.getElementById("order").value;
            if (currentTableNumber && order) {
                var orderRef = database.ref('orders/' + currentTableNumber);
                orderRef.once('value', function(snapshot) {
                    var orders = snapshot.val() || {};
                    if (orders[order]) {
                        orders[order]++;
                    } else {
                        orders[order] = 1;
                    }
                    orderRef.set(orders);
                });
                alert("Pedido enviado");
                document.getElementById("order").value = "";
            } else {
                alert("Por favor, rellena el campo de pedido");
            }
        }

        function checkPassword() {
            var password = document.getElementById("kitchenPassword").value;
            if (password === "cocina") {
                document.getElementById("kitchenPassword").style.display = "none";
                document.getElementById("kitchenContent").style.display = "block";
                loadOrders(); // Cargar la lista de pedidos al entrar en la interfaz de cocina
                // Escuchar cambios en la base de datos en tiempo real
                database.ref('orders').on('value', function(snapshot) {
                    loadOrders(); // Volver a cargar la lista de pedidos cuando haya cambios
                });
            } else {
                alert("Contraseña incorrecta");
            }
        }

        function loadOrders() {
            var orderList = document.getElementById("orderList");
            orderList.innerHTML = "";
            database.ref('orders').once('value').then(function(snapshot) {
                snapshot.forEach(function(childSnapshot) {
                    var tableNumber = childSnapshot.key;
                    var orders = childSnapshot.val();
                    for (var order in orders) {
                        var li = document.createElement("li");
                        var orderText = "Mesa " + tableNumber + ": " + order;
                        if (orders[order] > 1) {
                            orderText += " x" + orders[order];
                        }
                        li.textContent = orderText;
                        var deleteButton = document.createElement("button");
                        deleteButton.textContent = "Eliminar";
                        deleteButton.onclick = function() {
                            deleteOrder(tableNumber, order);
                        };
                        li.appendChild(deleteButton);
                        orderList.appendChild(li);
                    }
                });
            });
        }

        function deleteOrder(tableNumber, order) {
            var confirmDelete = confirm("¿Estás seguro de que quieres eliminar este pedido?");
            if (confirmDelete) {
                var orderRef = database.ref('orders/' + tableNumber + '/' + order);
                orderRef.remove();
            }
        }
    </script>
</body>
</html>
