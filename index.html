<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurante Interactivo</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <!-- Estilo CSS personalizado -->
    <style>
        /* Estilo para los botones de las secciones */
        button.section {
            padding: 10px 20px;
            font-size: 18px;
            background-color: green;
            color: white;
            border: none;
            cursor: pointer;
            margin: 5px;
        }

        /* Estilo para los botones de los platos */
        .dish {
            display: flex;
            align-items: center;
            margin: 5px 5px 5px 25px; /* Agregar margen izquierdo para tabular */
        }

        .dish span {
            flex-grow: 1;
        }

        .dish button {
            padding: 10px;
            font-size: 18px;
            background-color: blue;
            color: white;
            border: none;
            cursor: pointer;
            margin-left: 10px;
        }

        /* Estilo para los botones al pasar el ratón */
        button:hover {
            opacity: 0.8;
        }

        /* Disposición vertical de las mesas */
        #main {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #main button {
            width: 200px;
        }

        /* Ocultar lista desplegable por defecto */
        .dropdown-content {
            display: none;
            flex-direction: column;
            align-items: flex-start;
        }

        /* Mostrar lista desplegable cuando se hace clic */
        .show {
            display: flex;
        }

        /* Estilo para el contenedor de cocina */
        #kitchenContent {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        /* Estilo para la lista de pedidos */
        .order-list {
            list-style-type: none;
            padding-left: 20px;
        }

        .order-item {
            margin-left: 20px;
        }

        .order-item-control {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 10px 0;
        }

        .order-item-control button {
            padding: 5px 10px;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div id="main">
        <h1>Selecciona tu mesa</h1>
        <button class="section" onclick="goToCustomer(1)">Mesa 1</button>
        <button class="section" onclick="goToCustomer(2)">Mesa 2</button>
        <button class="section" onclick="goToCustomer(3)">Mesa 3</button>
        <button class="section" onclick="goToCustomer(4)">Mesa 4</button>
        <button class="section" onclick="goToCustomer(5)">Mesa 5</button>
        <button class="section" onclick="goToCustomer(6)">Mesa 6</button>
        <button class="section" onclick="goToCustomer(7)">Mesa 7</button>
        <button class="section" onclick="goToCustomer(8)">Mesa 8</button>
        <button class="section" onclick="goToCustomer(9)">Mesa 9</button>
        <button class="section" onclick="goToCustomer(10)">Mesa 10</button>
        <button class="section" onclick="goToKitchen()">COCINA</button>
    </div>

    <div id="customer" style="display:none;">
        <h1>Cliente - Mesa <span id="tableNumber"></span></h1>
        <div>
            <button class="section" onclick="toggleDropdown('entrantes')">Entrantes</button>
            <div id="entrantes" class="dropdown-content">
                <div class="dish"><span>Jamón ibérico - 5€</span><span>(<span>0</span>)</span><button onclick="addProvisionalOrder('Jamón ibérico', 5)">+</button></div>
                <div class="dish"><span>Ensaladilla rusa - 3€</span><span>(<span>0</span>)</span><button onclick="addProvisionalOrder('Ensaladilla rusa', 3)">+</button></div>
                <div class="dish"><span>Croquetas - 4€</span><span>(<span>0</span>)</span><button onclick="addProvisionalOrder('Croquetas', 4)">+</button></div>
            </div>
        </div>
        <div>
            <button class="section" onclick="toggleDropdown('platosPrincipales')">Platos principales</button>
            <div id="platosPrincipales" class="dropdown-content">
                <div class="dish"><span>Filete de ternera - 12€</span><span>(<span>0</span>)</span><button onclick="addProvisionalOrder('Filete de ternera', 12)">+</button></div>
                <div class="dish"><span>Merluza al horno - 10€</span><span>(<span>0</span>)</span><button onclick="addProvisionalOrder('Merluza al horno', 10)">+</button></div>
                <div class="dish"><span>Tartar de salmón y aguacate - 15€</span><span>(<span>0</span>)</span><button onclick="addProvisionalOrder('Tartar de salmón y aguacate', 15)">+</button></div>
            </div>
        </div>
        <div>
            <button class="section" onclick="toggleDropdown('postres')">Postres</button>
            <div id="postres" class="dropdown-content">
                <div class="dish"><span>Tarta de la abuela - 5€</span><span>(<span>0</span>)</span><button onclick="addProvisionalOrder('Tarta de la abuela', 5)">+</button></div>
                <div class="dish"><span>Natillas - 3€</span><span>(<span>0</span>)</span><button onclick="addProvisionalOrder('Natillas', 3)">+</button></div>
                <div class="dish"><span>Tarta de queso y fruta - 6€</span><span>(<span>0</span>)</span><button onclick="addProvisionalOrder('Tarta de queso y fruta', 6)">+</button></div>
            </div>
        </div>
        <div>
            <button class="section" onclick="toggleDropdown('bebidas')">Bebidas</button>
            <div id="bebidas" class="dropdown-content">
                <div class="dish"><span>Cocacola - 2€</span><span>(<span>0</span>)</span><button onclick="addProvisionalOrder('Cocacola', 2)">+</button></div>
                <div class="dish"><span>Agua - 1€</span><span>(<span>0</span>)</span><button onclick="addProvisionalOrder('Agua', 1)">+</button></div>
                <div class="dish"><span>Cerveza - 3€</span><span>(<span>0</span>)</span><button onclick="addProvisionalOrder('Cerveza', 3)">+</button></div>
                <div class="dish"><span>Vino - 4€</span><span>(<span>0</span>)</span><button onclick="addProvisionalOrder('Vino', 4)">+</button></div>
            </div>
        </div>
        <button class="section" onclick="goToProvisionalOrder()">Tramitar pedido</button>
    </div>

    <div id="provisionalOrder" style="display:none;">
        <h1>PEDIDO</h1>
        <div id="provisionalOrderList"></div>
        <button class="section" style="background-color:green;" onclick="confirmOrder()">CONFIRMAR</button>
        <button class="section" style="background-color:red;" onclick="goBackToCustomer()">ATRÁS</button>
    </div>

    <div id="kitchen" style="display:none;">
        <h1>Cocina</h1>
        <input type="password" id="kitchenPassword" placeholder="Introduce la contraseña">
        <button class="section" onclick="checkPassword()">Entrar</button>
        <div id="kitchenContent" style="display:none;">
            <h2>Pedidos</h2>
            <div id="orderList"></div>
            <button class="section" onclick="goBackToMain()">Volver</button>
        </div>
    </div>

    <script>
        // Configuración de Firebase
        var firebaseConfig = {

            apiKey: "AIzaSyD8h3lzN5yP5N0aZNjdmy7kDI0aClUc_Wk",
            authDomain: "clasepruebagad.firebaseapp.com",
            databaseURL: "https://clasepruebagad-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "clasepruebagad",
            storageBucket: "clasepruebagad.appspot.com",
            messagingSenderId: "319326223452",
            appId: "1:319326223452:web:90ce724342c15427a17a99"
        };
        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        var database = firebase.database();

        // Guardar número de mesa en localStorage
        function goToCustomer(tableNumber) {
            localStorage.setItem('tableNumber', tableNumber);
            document.getElementById('main').style.display = 'none';
            document.getElementById('customer').style.display = 'block';
            document.getElementById('tableNumber').innerText = tableNumber;
        }

        // Mostrar y ocultar secciones de platos
        function toggleDropdown(section) {
            var dropdown = document.getElementById(section);
            dropdown.classList.toggle('show');
        }

        // Añadir pedido provisional
        var provisionalOrder = {};

        function addProvisionalOrder(dish, price) {
            var notes = prompt("Añade alguna nota para este plato (opcional):");
            if (!provisionalOrder[dish]) {
                provisionalOrder[dish] = { quantity: 0, price: price, notes: [] };
            }
            provisionalOrder[dish].quantity++;
            if (notes) {
                provisionalOrder[dish].notes.push(notes);
            }
            updateProvisionalOrderList();
        }

        // Actualizar lista de pedidos provisionales
        function updateProvisionalOrderList() {
            var provisionalOrderList = document.getElementById('provisionalOrderList');
            provisionalOrderList.innerHTML = '';
            for (var dish in provisionalOrder) {
                var orderItem = document.createElement('div');
                orderItem.innerHTML = `<span>${dish} x${provisionalOrder[dish].quantity} - ${provisionalOrder[dish].price * provisionalOrder[dish].quantity}€</span>`;
                if (provisionalOrder[dish].notes.length > 0) {
                    var notesList = document.createElement('ul');
                    provisionalOrder[dish].notes.forEach(note => {
                        var noteItem = document.createElement('li');
                        noteItem.textContent = note;
                        notesList.appendChild(noteItem);
                    });
                    orderItem.appendChild(notesList);
                }
                provisionalOrderList.appendChild(orderItem);
            }
        }

        // Tramitar pedido
        function goToProvisionalOrder() {
            document.getElementById('customer').style.display = 'none';
            document.getElementById('provisionalOrder').style.display = 'block';
            updateProvisionalOrderList();
        }

        // Confirmar pedido
        function confirmOrder() {
            var tableNumber = localStorage.getItem('tableNumber');
            database.ref('orders/' + tableNumber).set(provisionalOrder);
            provisionalOrder = {}; // Limpiar pedido provisional
            alert('¡Pedido confirmado!');
            goBackToCustomer();
        }

        // Volver a la selección de platos
        function goBackToCustomer() {
            document.getElementById('provisionalOrder').style.display = 'none';
            document.getElementById('customer').style.display = 'block';
        }

        // Acceso a la cocina
        function goToKitchen() {
            document.getElementById('main').style.display = 'none';
            document.getElementById('kitchen').style.display = 'block';
        }

        // Verificar contraseña de cocina
        function checkPassword() {
            var password = document.getElementById('kitchenPassword').value;
            if (password === '1234') { // Contraseña de ejemplo
                document.getElementById('kitchenContent').style.display = 'block';
                loadOrders();
            } else {
                alert('Contraseña incorrecta');
            }
        }

        // Cargar pedidos en la cocina
        function loadOrders() {
            var orderList = document.getElementById('orderList');
            orderList.innerHTML = '';
            database.ref('orders').on('value', function(snapshot) {
                snapshot.forEach(function(childSnapshot) {
                    var tableNumber = childSnapshot.key;
                    var order = childSnapshot.val();
                    var orderItem = document.createElement('div');
                    orderItem.innerHTML = `<h3>Mesa ${tableNumber}</h3>`;
                    for (var dish in order) {
                        var dishItem = document.createElement('div');
                        dishItem.innerHTML = `<span>${dish} x${order[dish].quantity} - ${order[dish].price * order[dish].quantity}€</span>`;
                        if (order[dish].notes.length > 0) {
                            var notesList = document.createElement('ul');
                            order[dish].notes.forEach(note => {
                                var noteItem = document.createElement('li');
                                noteItem.textContent = note;
                                notesList.appendChild(noteItem);
                            });
                            dishItem.appendChild(notesList);
                        }
                        orderItem.appendChild(dishItem);
                    }
                    orderList.appendChild(orderItem);
                });
            });
        }

        // Volver a la pantalla principal desde la cocina
        function goBackToMain() {
            document.getElementById('kitchen').style.display = 'none';
            document.getElementById('main').style.display = 'block';
        }
    </script>
</body>
</html>
